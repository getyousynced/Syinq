
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Role { 
  Student
  Faculty
}

model User {
  id String @id @default(uuid())
  name String 
  email String @unique
  phoneNumber BigInt @unique
  // for email verification
  isActivated Boolean @default(false)
  gender String?
  password String
  suspended Boolean @default(false)
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt

  role Role


  cars Car[] @relation("UserCars")
  addressed Address[]
  offerRide OfferRide?
  findRides FindRide[] @relation("riders")
}

model Car {
  carId String @id @default(uuid())
  typeOfRide String
  carNumber String @unique
  carName String
  seatCapacity Int 
  ownerId String?
  owner User? @relation("UserCars", fields: [ownerId], references: [id])

  offerRides OfferRide[] @relation("CarOfferRides")
}

model Address {
  addressId String @id @default(uuid())
  user User @relation(fields: [userId], references: [id])
  userId String 
  street1 String
  street2 String?
  landmark String?
  pincode Int
  state String
  country String

  offerRidesOrigin OfferRide[] @relation("originAddressId")
  offerRidesDestination OfferRide[] @relation("destinationAddressId")
  findRidesOrigin FindRide[] @relation("FindrideOrigin")
  findRidesStops FindRide[] @relation("FindrideStops")
}

model OfferRide {
  id String @id @default(uuid())
  user User @relation(fields: [userId], references: [id])
  userId String @unique
  originAddress Address @relation("originAddressId", fields: [originAddressId], references: [addressId])
  originAddressId String
  destinationAddress Address @relation("destinationAddressId", fields: [destinationAddressId], references: [addressId])
  destinationAddressId String
  
  askForFair Boolean
  amount Int

  
  car Car @relation("CarOfferRides", fields: [carId], references: [carId])
  carId String
}

model FindRide {
  rideId String @id @default(uuid())
  originAddressId String
  originAddress Address @relation("FindrideOrigin", fields: [originAddressId], references: [addressId])
  stops Address[] @relation("FindrideStops")
  dateTime DateTime
  riders User[] @relation("riders")
  seat_capacity Int
  ask_for_fair Boolean
  amount_asked Int
}

// model Chats {
//   chat_id Int @id @default(autoincrement())
//   chat_users User[] @relation("ChatParticipants")
//   chats Chat[]
// }

// model Chat {
//   chatId Int @id @default(autoincrement())
//   dateTime DateTime @default(now())
//   user User @relation(fields: [userId], references: [id])
//   userId String
//   content String
// }
