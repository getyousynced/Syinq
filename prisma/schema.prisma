
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id String @id @default(cuid()) @unique
  name String 
  email String @unique
  phoneNo Int @unique
  isPhoneNoVerified Boolean 
  gender String?
  password String
  suspended Boolean @default(false)
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt

  cars Car[] @relation("UserCars")
  addressed Address[]
  offerRide OfferRide?
  findRides FindRide[] @relation("riders")
}

model Car {
  carId Int @id @default(autoincrement())
  typeOfRide String
  carNumber String @unique
  carName String
  seatCapacity Int 
  ownerId String?
  owner User? @relation("UserCars", fields: [ownerId], references: [id])

  offerRides OfferRide[] @relation("CarOfferRides")
}

model Address {
  addressId Int @id @default(autoincrement())
  user User @relation(fields: [userId], references: [id])
  userId String @unique
  street1 String
  street2 String?
  landmark String?
  pincode Int
  state String
  country String

  offerRidesOrigin OfferRide[] @relation("originAddress")
  offerRidesDestination OfferRide[] @relation("destinationAddress")
  findRidesOrigin FindRide[] @relation("FindrideOrigin")
  findRidesStops FindRide[] @relation("FindrideStops")
}

model OfferRide {
  id Int @id @default(autoincrement())
  user User @relation(fields: [userId], references: [id])
  userId String @unique

  originAddressId Int
  originAddress Address @relation("originAddress", fields: [originAddressId], references: [addressId])
  destinationAddressId Int
  destinationAddress Address @relation("destinationAddress", fields: [destinationAddressId], references: [addressId])
  
  askForFair Boolean
  amount Int

  carId Int
  car Car @relation("CarOfferRides", fields: [carId], references: [carId])
}

model FindRide {
  rideId Int @id @default(autoincrement())
  originAddressId Int
  originAddress Address @relation("FindrideOrigin", fields: [originAddressId], references: [addressId])
  stops Address[] @relation("FindrideStops")
  dateTime DateTime
  riders User[] @relation("riders")
  seat_capacity Int
  ask_for_fair Boolean
  amount_asked Int
}

// model Chats {
//   chat_id Int @id @default(autoincrement())
//   chat_users User[] @relation("ChatParticipants")
//   chats Chat[]
// }

// model Chat {
//   chatId Int @id @default(autoincrement())
//   dateTime DateTime @default(now())
//   user User @relation(fields: [userId], references: [id])
//   userId String
//   content String
// }
